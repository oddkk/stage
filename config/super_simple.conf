version 0.1.0;

# device basic.print(T=int);

device basic.lighting.dmx universe;
device midi.novation.launchpad lp;

type color_rgbwau = int[6];

namespace color {
	namespace rgbwau {
		device basic.constant off    (value = [  0,   0,   0,   0,   0,   0]);
		device basic.constant red    (value = [255,   0,   0,   0,   0,   0]);
		device basic.constant green  (value = [  0, 255,   0,   0,   0,   0]);
		device basic.constant blue   (value = [  0,   0, 255,   0,   0,   0]);
		device basic.constant white  (value = [  0,   0,   0, 255,   0,   0]);
		device basic.constant amber  (value = [  0,   0,   0,   0, 255,   0]);
		device basic.constant uv     (value = [  0,   0,   0,   0,   0, 255]);
	}
}

namespace martin {
	device_type thrill_par_64_led {
		output default dmx: int[6];
		input color: color_rgbwau;

		dmx <- color;
	}
}

device_type radio_select (N: int, T: type) {
	input values: $T[$N];
	input default in: int[$N];
	output default out: $T;

	device basic.radio radio(N=N);
	device basic.select select(N=N, T=T);

	radio.radio <- in;
	select.select <- radio.out;
	select.case <- values;
	out <- select.out;
}


device martin.thrill_par_64_led led1;
device martin.thrill_par_64_led led2;

device radio_select color_select(N = 7, T = color_rgbwau);

color_select.values[0] <- color.rgbwau.off.out;
color_select.values[1] <- color.rgbwau.red.out;
color_select.values[2] <- color.rgbwau.green.out;
color_select.values[3] <- color.rgbwau.blue.out;
color_select.values[4] <- color.rgbwau.white.out;
color_select.values[5] <- color.rgbwau.amber.out;
color_select.values[6] <- color.rgbwau.uv.out;
color_select.in[..] <- lp.button_down[0][0..7];

led1.color <- color_select.out;
led2.color <- color_select.out;

universe.in[0..6]  <- led1.dmx;
universe.in[6..12] <- led2.dmx;


# device_type toggle_button(x: int, y: int, high: $T, low: $T, T: type,
# 	active_color: midi.novation.button_color) {
# 	output default out: int;
# 	input  default in:  int;

# 	device basic.toggle tgl (T = T);
# 	tgl.in <- lp.button_down[y][x];

# 	device basic.constant high_color (value = active_color);
# 	device basic.constant low_color (value = (red = 0, green = 0));
# 	device basic.select button_color (N = 2, T = midi.novation.button_color);

# 	button_color.case[0] <- low_color.out;
# 	button_color.case[1] <- high_color.out;

# 	button_color.select <- tgl.out;
# 	lp.button_color[y][x] <- button_color.out;

# 	device basic.constant high_value (value = 1);
# 	device basic.constant low_value  (value = 0);

# 	tgl.on_value  <- high_value.out;
# 	tgl.off_value <- low_value.out;

# 	device basic.constant threshold (value = 1);
# 	tgl.threshold <- threshold.out;

# 	out <- tgl.out;
# }

# device_type toggle_button(x: int, y: int, high: $T, low: $T, T: type,
# 	active_color: midi.novation.button_color) {
# 	output default out: int;
# 	input  default in:  int;

# 	device basic.toggle tgl (T = T);
# 	tgl.in <- lp.button_down[y][x];

# 	device basic.select(N = 2, T = midi.novation.button_color) {
# 		case[0] <- (0, 0);
# 		case[1] <- active_color;

# 		select <- tgl.out;
# 		lp.button_color[y][x] <- out;
# 	}

# 	tgl.on_value  <- 1;
# 	tgl.off_value <- 0;

# 	tgl.threshold <- 1;

# 	out <- tgl.out;
# }

# device toggle_button asdf0 (x = 0, y = 0, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf1 (x = 1, y = 1, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf2 (x = 2, y = 2, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf3 (x = 3, y = 3, high = 3, low = 0, active_color=(red=0, green=2));
# device toggle_button asdf4 (x = 4, y = 4, high = 3, low = 0, active_color=(red=0, green=2));
# device toggle_button asdf5 (x = 5, y = 5, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf6 (x = 6, y = 6, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf7 (x = 7, y = 7, high = 3, low = 0, active_color=(red=3, green=2));

# device toggle_button asdf8 (x = 0, y = 7, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf9 (x = 1, y = 6, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf10(x = 2, y = 5, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf11(x = 3, y = 4, high = 3, low = 0, active_color=(red=0, green=2));
# device toggle_button asdf12(x = 4, y = 3, high = 3, low = 0, active_color=(red=0, green=2));
# device toggle_button asdf13(x = 5, y = 2, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf14(x = 6, y = 1, high = 3, low = 0, active_color=(red=3, green=2));
# device toggle_button asdf15(x = 7, y = 0, high = 3, low = 0, active_color=(red=3, green=2));